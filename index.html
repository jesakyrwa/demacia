<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Pro Yƒ±lan Oyunu</title>
<style>
:root{
  --bg1:#0f2027;
  --bg2:#203a43;
  --bg3:#2c5364;
  --snake:#3aff7a;
  --food:#ff4d4d;
}

body{
  margin:0;
  min-height:100vh;
  background: radial-gradient(circle at top,var(--bg1),var(--bg2),var(--bg3));
  display:flex;
  flex-direction:column;
  align-items:center;
  color:#fff;
  font-family:Arial,sans-serif;
}

h1{margin:10px}

.controls{margin-bottom:10px}

button,select{
  padding:6px 10px;
  border-radius:6px;
  border:none;
  cursor:pointer;
}

canvas{
  background:rgba(0,0,0,.6);
  border-radius:12px;
  box-shadow:0 0 30px rgba(0,0,0,.8);
  display:none;
}
</style>
</head>
<body>

<h1>üêç Pro Yƒ±lan Oyunu</h1>

<div class="controls">
  <button onclick="startGame()">‚ñ∂ Ba≈üla</button>
</div>

<canvas id="game" width="420" height="420"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const grid = 20;

let snake, food, dx, dy, score, speed, loop;
let highScore = localStorage.getItem("snakeHighScore") || 0;
let audioCtx, musicOsc;

// üîä SESLER
function initAudio(){
  if(audioCtx) return;
  audioCtx = new (window.AudioContext||window.webkitAudioContext)();

  // Arka plan m√ºziƒüi (soft wave)
  musicOsc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  musicOsc.type="sine";
  musicOsc.frequency.value=110;
  gain.gain.value=0.03;
  musicOsc.connect(gain).connect(audioCtx.destination);
  musicOsc.start();
}

function beep(freq,d=0.1){
  if(!audioCtx) return;
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.frequency.value=freq;
  o.connect(g).connect(audioCtx.destination);
  g.gain.value=0.15;
  o.start();
  g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+d);
  o.stop(audioCtx.currentTime+d);
}

// üéÆ OYUN
function startGame(){
  initAudio();
  canvas.style.display="block";
  snake=[{x:200,y:200}];
  dx=grid; dy=0;
  score=0;
  speed=120;
  food=randomFood();
  clearInterval(loop);
  loop=setInterval(gameLoop,speed);
}

function randomFood(){
  return{
    x:Math.floor(Math.random()*21)*grid,
    y:Math.floor(Math.random()*21)*grid
  }
}

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp"&&dy===0){dx=0;dy=-grid}
  if(e.key==="ArrowDown"&&dy===0){dx=0;dy=grid}
  if(e.key==="ArrowLeft"&&dx===0){dx=-grid;dy=0}
  if(e.key==="ArrowRight"&&dx===0){dx=grid;dy=0}
});

function gameLoop(){
  let head={x:snake[0].x+dx,y:snake[0].y+dy};

  // DUVARLARDAN GE√áƒ∞≈û
  if(head.x<0) head.x=canvas.width-grid;
  if(head.y<0) head.y=canvas.height-grid;
  if(head.x>=canvas.width) head.x=0;
  if(head.y>=canvas.height) head.y=0;

  // KENDƒ∞NE √áARPMA
  if(snake.some(s=>s.x===head.x&&s.y===head.y)){
    beep(120,.3);
    if(score>highScore){
      highScore=score;
      localStorage.setItem("snakeHighScore",highScore);
    }
    alert(`Oyun Bitti!\nSkor:${score}\nRekor:${highScore}`);
    startGame();
    return;
  }

  snake.unshift(head);

  if(head.x===food.x&&head.y===food.y){
    score++;
    beep(600);
    food=randomFood();
    if(speed>60){
      speed-=5;
      clearInterval(loop);
      loop=setInterval(gameLoop,speed);
    }
  }else{
    snake.pop();
  }

  draw();
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // GRID ARKA PLAN
  ctx.strokeStyle="rgba(255,255,255,.05)";
  for(let i=0;i<canvas.width;i+=grid){
    ctx.beginPath();
    ctx.moveTo(i,0);
    ctx.lineTo(i,canvas.height);
    ctx.stroke();
  }

  // YILAN
  snake.forEach((p,i)=>{
    ctx.beginPath();
    ctx.fillStyle=i===0?"#6aff9f":"#2ecc71";
    ctx.arc(p.x+grid/2,p.y+grid/2,grid/2-2,0,Math.PI*2);
    ctx.fill();

    // G√ñZ
    if(i===0){
      ctx.fillStyle="#000";
      ctx.beginPath();
      ctx.arc(p.x+grid/2+3,p.y+grid/2-3,2,0,Math.PI*2);
      ctx.fill();
    }
  });

  // YEM (ELMA BENZERƒ∞)
  ctx.beginPath();
  ctx.fillStyle="#ff4d4d";
  ctx.arc(food.x+grid/2,food.y+grid/2,grid/2-3,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle="#fff";
  ctx.font="14px Arial";
  ctx.fillText("Skor: "+score,10,18);
  ctx.fillText("Rekor: "+highScore,10,34);
}
</script>
</body>
</html>
