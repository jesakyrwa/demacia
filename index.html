<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Three.js FPS Arena</title>
<style>
body { margin:0; overflow:hidden; background:#000; }
#info {
 position:absolute;
 top:50%;
 width:100%;
 text-align:center;
 color:white;
 font-family:Arial;
 cursor:pointer;
}
</style>
</head>
<body>

<div id="info">Tıklayın – Oyuna Gir</div>

<script type="module">
import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.158/build/three.module.js";
import { PointerLockControls } from "https://cdn.jsdelivr.net/npm/three@0.158/examples/jsm/controls/PointerLockControls.js";

/* ================= SETUP ================= */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x0b0f14);

const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

/* ================= LIGHT ================= */
scene.add(new THREE.HemisphereLight(0xffffff, 0x444444, 1));
const dirLight = new THREE.DirectionalLight(0xffffff, 0.5);
dirLight.position.set(5,10,2);
scene.add(dirLight);

/* ================= CONTROLS ================= */
const controls = new PointerLockControls(camera, document.body);
document.getElementById("info").onclick = () => controls.lock();
controls.addEventListener("lock", ()=>info.style.display="none");
controls.addEventListener("unlock", ()=>info.style.display="");

scene.add(controls.getObject());

/* ================= FLOOR ================= */
const floor = new THREE.Mesh(
 new THREE.PlaneGeometry(200,200),
 new THREE.MeshStandardMaterial({color:0x111111})
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

/* ================= WALLS ================= */
const walls = [];
function wall(x,z,w,d){
 const m = new THREE.Mesh(
  new THREE.BoxGeometry(w,5,d),
  new THREE.MeshStandardMaterial({color:0x222222})
 );
 m.position.set(x,2.5,z);
 scene.add(m);
 walls.push(m);
}
wall(0,-100,200,5);
wall(0,100,200,5);
wall(-100,0,5,200);
wall(100,0,5,200);

/* ================= PLAYER ================= */
const velocity = new THREE.Vector3();
const direction = new THREE.Vector3();
const keys = {};

addEventListener("keydown",e=>keys[e.code]=true);
addEventListener("keyup",e=>keys[e.code]=false);

/* ================= SHOOT ================= */
const raycaster = new THREE.Raycaster();
addEventListener("mousedown",()=>{
 if(!controls.isLocked) return;
 raycaster.setFromCamera(new THREE.Vector2(0,0), camera);
 const hits = raycaster.intersectObjects(walls);
 if(hits.length){
  hits[0].object.material.color.set(0xff0000);
 }
});

/* ================= LOOP ================= */
let prev = performance.now();

function animate(){
 requestAnimationFrame(animate);
 const now = performance.now();
 const delta = (now-prev)/1000;
 prev = now;

 velocity.x -= velocity.x * 10 * delta;
 velocity.z -= velocity.z * 10 * delta;

 direction.z = Number(keys["KeyW"]) - Number(keys["KeyS"]);
 direction.x = Number(keys["KeyD"]) - Number(keys["KeyA"]);
 direction.normalize();

 if(keys["KeyW"]||keys["KeyS"]) velocity.z -= direction.z * 40 * delta;
 if(keys["KeyA"]||keys["KeyD"]) velocity.x -= direction.x * 40 * delta;

 controls.moveRight(-velocity.x * delta);
 controls.moveForward(-velocity.z * delta);

 renderer.render(scene, camera);
}

animate();
</script>
</body>
</html>
