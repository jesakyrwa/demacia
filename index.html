<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Cryzone Arena</title>
<style>
body{
  margin:0;
  background:radial-gradient(circle at top,#0f2027,#203a43,#2c5364);
  overflow:hidden;
}
canvas{
  display:block;
}
</style>
</head>
<body>
<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

const keys={};
let mouse={x:0,y:0,down:false};

document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);
canvas.addEventListener("mousemove",e=>{
  const r=canvas.getBoundingClientRect();
  mouse.x=e.clientX-r.left;
  mouse.y=e.clientY-r.top;
});
canvas.addEventListener("mousedown",()=>mouse.down=true);
canvas.addEventListener("mouseup",()=>mouse.down=false);

// ---------- PLAYER ----------
const player={
  x:canvas.width/2,
  y:canvas.height/2,
  r:15,
  speed:4,
  hp:100
};

// ---------- BULLETS ----------
let bullets=[];
function shoot(x,y,angle,owner){
  bullets.push({
    x,y,
    dx:Math.cos(angle)*10,
    dy:Math.sin(angle)*10,
    owner
  });
}

// ---------- ENEMIES ----------
let enemies=[];
function spawnEnemy(){
  enemies.push({
    x:Math.random()*canvas.width,
    y:Math.random()*canvas.height,
    r:14,
    hp:50,
    cd:0
  });
}
for(let i=0;i<6;i++) spawnEnemy();

// ---------- GAME LOOP ----------
function update(){
  // movement
  if(keys.w) player.y-=player.speed;
  if(keys.s) player.y+=player.speed;
  if(keys.a) player.x-=player.speed;
  if(keys.d) player.x+=player.speed;

  // shooting
  if(mouse.down){
    const a=Math.atan2(mouse.y-player.y,mouse.x-player.x);
    if(!player.cooldown){
      shoot(player.x,player.y,a,"player");
      player.cooldown=10;
    }
  }
  if(player.cooldown) player.cooldown--;

  // bullets
  bullets.forEach(b=>{
    b.x+=b.dx;
    b.y+=b.dy;
  });
  bullets=bullets.filter(b=>
    b.x>0&&b.y>0&&b.x<canvas.width&&b.y<canvas.height
  );

  // enemies AI
  enemies.forEach(e=>{
    const a=Math.atan2(player.y-e.y,player.x-e.x);
    e.x+=Math.cos(a)*1.5;
    e.y+=Math.sin(a)*1.5;

    if(e.cd<=0){
      shoot(e.x,e.y,a,"enemy");
      e.cd=60;
    }
    e.cd--;
  });

  // collisions
  bullets.forEach(b=>{
    if(b.owner==="enemy"){
      const d=Math.hypot(b.x-player.x,b.y-player.y);
      if(d<player.r){
        player.hp-=10;
        b.dead=true;
      }
    }else{
      enemies.forEach(e=>{
        const d=Math.hypot(b.x-e.x,b.y-e.y);
        if(d<e.r){
          e.hp-=20;
          b.dead=true;
        }
      });
    }
  });

  bullets=bullets.filter(b=>!b.dead);
  enemies=enemies.filter(e=>e.hp>0);

  if(enemies.length<6) spawnEnemy();

  if(player.hp<=0){
    alert("Öldün!");
    location.reload();
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // arena grid
  ctx.strokeStyle="rgba(255,255,255,0.05)";
  for(let i=0;i<canvas.width;i+=50){
    ctx.beginPath();
    ctx.moveTo(i,0);
    ctx.lineTo(i,canvas.height);
    ctx.stroke();
  }

  // player
  ctx.beginPath();
  ctx.fillStyle="#00ffcc";
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fill();

  // enemies
  enemies.forEach(e=>{
    ctx.beginPath();
    ctx.fillStyle="#ff5555";
    ctx.arc(e.x,e.y,e.r,0,Math.PI*2);
    ctx.fill();
  });

  // bullets
  ctx.fillStyle="#fff";
  bullets.forEach(b=>{
    ctx.fillRect(b.x-2,b.y-2,4,4);
  });

  // UI
  ctx.fillStyle="white";
  ctx.fillText("HP: "+player.hp,20,30);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
